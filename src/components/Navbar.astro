---

---

<section class="flex justify-center items-center py-6">
    <nav class="fixed top-6 left-1/2 -translate-x-1/2 z-50 w-[95%] max-w-3xl bbh-sans-hegarty-regular">
        <div class="bg-white/90 backdrop-blur-md border border-purple-200/50 rounded-full px-8 py-4 shadow-xl shadow-purple-900/10">
            <ul class="flex flex-row justify-center items-center gap-2 text-base">
                <li class="relative">
                    <a class="nav-link flex items-center gap-2 text-gray-700 hover:text-purple-400 px-5 py-2 rounded-full relative" href="#inicio" data-section="inicio">
                        <img src="/icons/pokeball.svg" alt="Pokeball" class="pokeball-icon w-5 h-5 hidden" />
                        <span>Inicio</span>
                    </a>
                </li>
                <li class="relative">
                    <a class="nav-link flex items-center gap-2 text-gray-700 hover:text-purple-400 px-5 py-2 rounded-full relative" href="#tecnologias" data-section="tecnologias">
                        <img src="/icons/pokeball.svg" alt="Pokeball" class="pokeball-icon w-5 h-5 hidden" />
                        <span>Tecnologias</span>
                    </a>
                </li>
                <li class="relative">
                    <a class="nav-link flex items-center gap-2 text-gray-700 hover:text-purple-400 px-5 py-2 rounded-full relative" href="#proyectos" data-section="proyectos">
                        <img src="/icons/pokeball.svg" alt="Pokeball" class="pokeball-icon w-5 h-5 hidden" />
                        <span>Proyectos</span>
                    </a>
                </li>
                <li class="relative">
                    <a class="nav-link flex items-center gap-2 text-gray-700 hover:text-purple-400 px-5 py-2 rounded-full relative" href="#contacto" data-section="contacto">
                        <img src="/icons/pokeball.svg" alt="Pokeball" class="pokeball-icon w-5 h-5 hidden" />
                        <span>Contacto</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
</section>

<script>
    import { gsap } from "gsap";
    
    document.addEventListener('DOMContentLoaded', () => {
        const navLinks = document.querySelectorAll('.nav-link');
        const activeAnimations = new Map();
        let isScrolling = false;
        let scrollTimeout: number;
        
        function animatePokeball(pokeball: HTMLElement) {
            if (activeAnimations.has(pokeball)) {
                activeAnimations.get(pokeball).kill();
            }
            
            const animation = gsap.to(pokeball, {
                scale: 1.3,
                duration: 0.6,
                ease: "power1.inOut",
                yoyo: true,
                repeat: -1
            });
            
            activeAnimations.set(pokeball, animation);
        }
        
        function stopPokeballAnimation(pokeball: HTMLElement) {
            if (activeAnimations.has(pokeball)) {
                activeAnimations.get(pokeball).kill();
                activeAnimations.delete(pokeball);
                gsap.set(pokeball, { scale: 1 });
            }
        }
        
        function setActiveLink(targetSection: string) {
            navLinks.forEach(link => {
                const pokeball = link.querySelector('.pokeball-icon') as HTMLElement;
                const section = link.getAttribute('data-section');
                
                if (section === targetSection) {
                    if (pokeball) {
                        pokeball.classList.remove('hidden');
                        animatePokeball(pokeball);
                    }
                    link.classList.add('text-purple-700', 'font-bold');
                    link.classList.remove('text-gray-700');
                } else {
                    if (pokeball) {
                        pokeball.classList.add('hidden');
                        stopPokeballAnimation(pokeball);
                    }
                    link.classList.remove('text-purple-700', 'font-bold');
                    link.classList.add('text-gray-700');
                }
            });
        }
        
        function updateActiveSection() {
            if (isScrolling) return;
            
            const sections = document.querySelectorAll('section[id]');
            let currentSection = 'inicio';
            let closestDistance = Infinity;
            
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                const sectionId = section.getAttribute('id');
                
                if (!sectionId) return;
                
                const referencePoint = 200;
                const sectionMiddle = rect.top + (rect.height / 2);
                const distance = Math.abs(sectionMiddle - referencePoint);
                
                if (rect.top <= referencePoint && rect.bottom >= referencePoint) {
                    currentSection = sectionId;
                } else if (distance < closestDistance && rect.top <= referencePoint + 100) {
                    closestDistance = distance;
                    currentSection = sectionId;
                }
            });
            
            setActiveLink(currentSection);
        }
        
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                
                const targetId = link.getAttribute('href');
                const targetSection = link.getAttribute('data-section');
                if (!targetId || !targetSection) return;
                
                const targetElement = document.querySelector(targetId) as HTMLElement;
                
                if (targetElement) {
                    isScrolling = true;
                    
                    setActiveLink(targetSection);
                    
                    const navbarHeight = 100;
                    const targetPosition = targetElement.getBoundingClientRect().top + window.scrollY - navbarHeight;
                    
                    window.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                    
                    clearTimeout(scrollTimeout);
                    scrollTimeout = window.setTimeout(() => {
                        isScrolling = false;
                        updateActiveSection();
                    }, 1500);
                }
            });
        });
        
        window.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = window.setTimeout(() => {
                updateActiveSection();
            }, 150);
        });
        
        setActiveLink('inicio');
    });
</script>